<.game_title game_id={@game_id} />

<svg
  class="game-svg"
  width={@svg_width}
  height={@svg_height}
  viewbox={@svg_viewbox}
>
  <%= if @game do %>
    <.deck
      not_started={@game_state == :not_started}
      highlight={:deck in @playable_cards}
    />

    <%= unless @game_state == :not_started do %>
      <%= unless Enum.empty?(@game.table_cards) do %>
        <.table_card
          card={hd @game.table_cards}
          highlight={:table in @playable_cards}
        />
      <% end %>

      <%= for {pos, player} <- player_positions(@user_id, @game.players) do %>
        <.hand
          user_id={@user_id}
          holder={player.id}
          cards={player.hand}
          coord={hand_coord(pos, @svg_width, @svg_height)}
          playable_cards={@playable_cards}
        />
        <%= if player.held_card do %>
          <.held_card
            holder={player.id}
            card_name={player.held_card}
            coord={held_card_coord(pos, @svg_width, @svg_height)}
            highlight={:held in @playable_cards}
          />
        <% end %>
      <% end %>
    <% end %>
  <% end %>
</svg>

<div class="game-controls">
  <.create_game_form
    socket={@socket}
    trigger={@trigger_submit_create}
  />

  <%= if @game do %>
    <.leave_game_form
      socket={@socket}
      trigger={@trigger_submit_leave}
    />

    <%= if @game.state == :not_started and
           @game.host_id == @user_id do %>
      <.start_game_form socket={@socket} />
    <% end %>
  <% end %>
</div>
